# 层叠上下文、层叠等级、层叠顺序

## 层叠上下文

### 定义
> 层叠上下文（stacking context）是HTML元素的三维概念，这些HTML元素在一条假想的相对于面向（电脑屏幕的）视窗或者网页的用户的z轴上延伸，HTML元素依照其自身属性按照优先顺序占用

### 形成层叠上下文的条件
1. 根（HTML）元素
2. z-index不为'auto'的绝对/相对定位元素
3. flex 项(父元素 display 为 flex|inline-flex)，注意是子元素，不是父元素创建层叠上下文
4. css3新属性
 * opacity值小于1的属性，会触z-index
 * transform属性值不为'none'的元素

::: danger
z-index属性值并不是在任何元素上都有效果。它仅在定位元素（定义了position属性，且属性值为非static值的元素）上有效果。
:::

### 层叠准则

* 谁大谁上：当具有明显的层叠水平标示的时候，如识别的z-indx值，在同一个层叠上下文领域，层叠水平值大的那一个覆盖小的那一个。通俗讲就是官大的压死官小的。
* 后来居上：当元素的层叠水平一致、层叠顺序相同的时候，在DOM流中处于后面的元素会覆盖前面的元素。

## 层叠等级/水平
> 层叠等级（stacking level）决定了同一个层叠上下文中元素在z轴上的显示顺序
这里分两种情况：
* 在同一层叠上下文中，它描述定义的是该层叠上下文中的层叠上下文在Z轴上的上下顺序
* 在其他普通元素中它描述的是这些普通元素在Z轴上的上下顺序

## 层叠顺序
>层叠顺序表示发生层叠时有着特定的层叠显示顺序

::: warning
层叠上下文和层叠水平是概念，层叠顺序是规则
:::

层叠顺序规则遵循下图：
![title](https://image.zhangxinxu.com/image/blog/201601/2016-01-07_223349.png)